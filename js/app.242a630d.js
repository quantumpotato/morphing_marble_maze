(function(t){function e(e){for(var a,c,s=e[0],l=e[1],i=e[2],b=0,d=[];b<s.length;b++)c=s[b],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&d.push(r[c][0]),r[c]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,i||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(a=!1)}a&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},r={app:0},o=[];function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/morphing_marble_maze/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var i=0;i<s.length;i++)e(s[i]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"10d9":function(t,e,n){},1837:function(t,e,n){"use strict";n("4ee6")},"4ee6":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),r=n("c61c"),o={class:"app-wrapper"};function c(t,e,n,r,c,s){var l=Object(a["F"])("router-view");return Object(a["z"])(),Object(a["g"])("div",o,[Object(a["j"])(l)])}var s={},l=n("6b0d"),i=n.n(l);const u=i()(s,[["render",c]]);var b=u,d=n("6c02");function f(t,e,n,r,o,c){var s=Object(a["F"])("game-board");return Object(a["z"])(),Object(a["e"])(s)}var v={key:0,class:"game__wrapper"},O={class:"game-score"},j={class:"game-health"},p={class:"game__board"},h=["title"],g={class:"game-message"};function m(t,e,n,r,o,c){var s=Object(a["F"])("event-log");return Object(a["z"])(),Object(a["g"])(a["a"],null,[o.state.payload.player?(Object(a["z"])(),Object(a["g"])("div",v,[Object(a["h"])("div",O,"💎 "+Object(a["I"])(o.state.payload.score)+" / "+Object(a["I"])(o.MAX_SCORE),1),Object(a["h"])("div",j,[(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["D"])(c.player.health,(function(t){return Object(a["z"])(),Object(a["g"])("div",{key:t,class:Object(a["s"])(t["class"])},null,2)})),128))]),Object(a["h"])("div",p,[(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["D"])(c.squares,(function(t){return Object(a["z"])(),Object(a["g"])("div",{key:t.index,class:Object(a["s"])(t["class"])},null,2)})),128)),(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["D"])(o.walls,(function(t,e){return Object(a["z"])(),Object(a["g"])("div",{key:e,class:Object(a["s"])(c.getWallClass(t)),title:t.title},null,10,h)})),128)),Object(a["h"])("div",{class:Object(a["s"])(c.player["class"])}," 🙃 ",2),c.goal_class?(Object(a["z"])(),Object(a["g"])("div",{key:0,class:Object(a["s"])(c.goal_class)},"💎",2)):Object(a["f"])("",!0),(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["D"])(c.monsters,(function(t){return Object(a["z"])(),Object(a["g"])(a["a"],{key:t.id},[(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["D"])(t.prints,(function(t,e){return Object(a["z"])(),Object(a["g"])("div",{key:e,class:Object(a["s"])(t["class"])},Object(a["I"])(t.icon),3)})),128)),Object(a["h"])("div",{class:Object(a["s"])(t["class"])},Object(a["I"])(t.icon),3)],64)})),128)),(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["D"])(o.events,(function(t){return Object(a["z"])(),Object(a["g"])("div",{key:t.id,class:Object(a["s"])(t["class"])},Object(a["I"])(t.icon),3)})),128))]),Object(a["h"])("div",g,Object(a["I"])(o.message),1)])):Object(a["f"])("",!0),Object(a["j"])(s,{events:o.state.events},null,8,["events"])],64)}var w=n("3835"),_=(n("4160"),n("d3b7"),n("159b"),n("99af"),n("d81d"),n("4de4"),n("4fad"),n("4795"),n("2ef0")),k=(n("e25e"),n("caad"),n("2532"),n("ac1f"),n("841c"),n("a15b"),n("73ba")),z=n.n(k),E="PREVIOUS_STATE",A={__code:parseInt(1e12*Math.random()),events:[],payload:{player:[2,2,6],possible_goals:Object(_["range"])(36).map((function(t){return[t%6,parseInt(t/6)]})),score:0,shield:"none",status:"playing",walls:{"13,8":"solid","4,13":"solid","8,13":"solid","8,1":"solid","2,1":"solid","10,1":"solid","1,4":"solid","13,12":"solid","1,2":"solid","6,1":"solid","13,6":"solid","13,4":"solid","2,13":"solid","1,6":"solid","1,10":"solid","1,8":"solid","10,13":"solid","4,1":"solid","6,13":"solid","13,2":"solid","12,1":"solid","13,10":"solid","12,13":"solid","1,12":"solid"}}};Object.assign(A,z.a.get(E));var I=n("9a0e"),M=n("b85c"),S=(n("a434"),n("b64b"),n("7db0"),6),P=6,D=2*S+1,C=2*P+1,R=12,T=6,W=18,U=36,q=[0,0],F=[q,q,q,q,q,q,q,q,q,q,q,q];function J(t){var e=t.score,n=t.possible_goals;if(e===U)return t;var a=parseInt(Math.random()*n.length),r=n[a];n.splice(a,1),t["goal"]=r;var o=t["tiles"][r],c=Object(w["a"])(o,4),s=c[0],l=(c[1],c[2]),i=c[3];t["tiles"][r]=[s,"goal",l,i]}function L(t){var e,n=t.player,a=t.tiles,r=t.monsters,o=Object(w["a"])(n,3),c=o[0],s=o[1];o[2];e=c<=3&&s<=3?[6,6]:[1,1];var l=0===Object.keys(r).length?1:2,i=e,u=Object(w["a"])(i,2),b=u[0],d=u[1],f=[b,d,l,F.concat([e])],v=a[e],O=Object(w["a"])(v,4),j=(O[0],O[1]),p=O[2],h=O[3],y=[l,j,p,h];t["tiles"][e]=y,r.push(f)}function N(){var t={tiles:{},walls:{},possible_goals:[],events:[],player:[2,2,6],monsters:[],shield:"none",score:0,goal:[0,0]};return B(t),window.maze=t,J(t),L(t),t}function B(t){for(var e=1;e<=P;e++)for(var n=1;n<=S;n++)H(t,n,e);window.walls=t["walls"]}function X(t,e,n,a){var r,o;return r=0===e?[[t,e+1]]:e===a?[[t,e-1]]:[[t,e-1],[t,e+1]],o=0===t?[[t+1,e]]:t===n?[[t-1,e]]:[[t-1,e],[t+1,e]],r.concat(o)}function Y(t,e){return[[2*t,2*e-1],[2*t+1,2*e],[2*t,2*e+1],[2*t-1,2*e]]}function G(t,e){var n,a=Object(M["a"])(t);try{for(a.s();!(n=a.n()).done;){var r=n.value,o=void 0,c=Object(w["a"])(r,2),s=c[0],l=c[1];o=1===s||s===D||1===l||l===C?"solid":"open",e["walls"][r]=o}}catch(i){a.e(i)}finally{a.f()}}function H(t,e,n){var a=[e,n],r=X(e,n,S,P),o=Y(e,n),c=["open","open",r,o];t["tiles"][a]=c,G(o,t),t["possible_goals"].push(a)}function V(t,e){var n=Object(w["a"])(t,4),a=n[0],r=n[1],o=n[2],c=n[3];return"north"===e?a:"east"===e?r:"south"===e?o:"west"===e?c:void 0}function $(t){return"open"===t||"sand"==t}function K(t,e){var n,a=Object(M["a"])(t);try{for(a.s();!(n=a.n()).done;){var r=n.value,o=e[r];if("stone"!=o&&"solid"!=o)return!1}}catch(c){a.e(c)}finally{a.f()}return!0}function Q(t,e,n){var a,r=Object(M["a"])(e);try{for(r.s();!(a=r.n()).done;){var o=a.value,c=Object(w["a"])(o,2),s=c[0],l=c[1];1===s||s===C||1===l||l===D||(n[o]=t)}}catch(i){r.e(i)}finally{r.f()}}function Z(t,e,n,a,r,o){tt(t,e,n,a,!1),tt(t,e,r,o,!0)}function tt(t,e,n,a,r){var o,c=t.walls,s=(t.tiles,c[e]);r?o=s:"open"===s?o="sand":"sand"===s&&(o="stone");var l=Object(w["a"])(a,4),i=(l[0],l[1],l[2],l[3]),u=Object(w["a"])(e,2),b=u[0],d=u[1],f=i.filter((function(t){var e=Object(w["a"])(t,2),n=e[0],a=e[1];return n!=b||a!=d})),v=K(f,c);v&&(r?"stone"===s&&Q("open",f,c):"sand"!==s&&"open"!==s||Q("open",f,c)),c[e]=o}function et(t,e,n,a,r,o,c){c.tiles;var s=Object(w["a"])(e,3),l=(s[0],s[1],s[2]),i=Object(w["a"])(r,2),u=i[0],b=i[1],d=[u,b,l],f=Object(w["a"])(n,4),v=(f[0],f[1]),O=f[2],j=f[3],p=["open",v,O,j],h=Object(w["a"])(o,4),y=(h[0],h[1]),g=h[2],m=h[3],_=["player",y,g,m];Z(c,t,r,_,a,p),c["player"]=d}function nt(t,e,n,a,r){var o=r.tiles,c=r.walls,s=[n,a],l=o[s],i=Object(w["a"])(l,4),u=(i[0],i[1],i[2],i[3]),b=V(u,t),d=c[b];if($(d)){var f=at(n,a,t),v=o[f];return!!v&&(et(b,e,l,s,f,v,r,t),!0)}return!1}function at(t,e,n){return"north"===n?[t,e-1]:"east"===n?[t+1,e]:"south"===n?[t,e+1]:"west"===n?[t-1,e]:void 0}function rt(){var t=Object(a["B"])({payload:N()}),e={push:function(e,n){var a=n.input;n.code;if(a){var r=ht(a,t.payload);t.payload=r}}};return{channel:e,state:t}}function ot(t){var e=t.player,n=t.goal,a=t.score,r=Object(w["a"])(e,3),o=r[0],c=r[1],s=r[2],l=Object(w["a"])(n,2),i=l[0],u=l[1];o==i&&c==u&&(t["score"]=a+1,t["player"]=[o,c,Math.min(s+1,T)],J(t))}function ct(t,e,n){var a=Object(w["a"])(e,4),r=a[0],o=a[1],c=a[2],s=a[3],l=st(r,n,t,"north"),i=st(o,n,t,"east"),u=st(c,n,t,"south"),b=st(s,n,t,"west");return l.concat(i).concat(u).concat(b)}function st(t,e,n,a){var r=e[t],o="open"===r||"sand"===r;if(o){var c=Object(w["a"])(n,2),s=c[0],l=c[1],i=pt(s,l,a);return lt(i)?[i]:[]}return[]}function lt(t){var e=Object(w["a"])(t,2),n=e[0],a=e[1];return n>0&&a>0&&n<=6&&a<=6}function it(t){var e,n=t.monsters,a=t.tiles,r=t.player,o=t.walls,c=Object(w["a"])(r,3),s=c[0],l=c[1],i=(c[2],Object(M["a"])(n));try{for(i.s();!(e=i.n()).done;){var u=e.value,b=Object(w["a"])(u,4),d=b[0],f=b[1],v=(b[2],b[3]),O=[d,f],j=a[O],p=Object(w["a"])(j,4),h=(p[0],p[1],p[2],p[3]);vt(d,f,s,l,t)&&ft(d,f,t);var y=ct(O,h,o),g=dt(y,v),m=void 0,_=void 0;if(0===g.length){var x=parseInt(Math.random()*y.length);m=y[x],_=F.concat([O])}else{var k=parseInt(Math.random()*g.length);m=g[k],_=v}bt(O,m,_,j,u,t)}}catch(z){i.e(z)}finally{i.f()}}function ut(t){while(t.length>R)console.log("PRUNE HAPPENS"),t.shift();return t}function bt(t,e,n,a,r,o){o.monsters,o.tiles;var c=Object(w["a"])(r,4),s=(c[0],c[1],c[2]),l=(c[3],Object(w["a"])(e,2)),i=l[0],u=l[1],b=n.concat([[i,u]]),d=[i,u,s,ut(b)],f=Object(w["a"])(a,4),v=(f[0],f[1]),O=f[2],j=f[3],p=["open",v,O,j];o["tiles"][t]=p;var h=Object(w["a"])(o["tiles"][e],4),y=(h[0],h[1]),g=h[2],m=h[3],_=[s,y,g,m];o["tiles"][e]=_;var x=1===s?0:1;o["monsters"].splice(x,1,d)}function dt(t,e){return t.filter((function(t){var n=Object(w["a"])(t,2),a=n[0],r=n[1];return!e.find((function(t){var e=Object(w["a"])(t,2),n=e[0],o=e[1];return a===n&&r===o}))}))}function ft(t,e,n){var a=n.player,r=Object(w["a"])(a,3),o=r[0],c=r[1],s=r[2];n["player"]=[o,c,s-2];var l={from:[t,e],to:[o,c]};n.events.push(l)}function vt(t,e,n,a,r){return a<e&&n==t?Ot("north",t,e,t,a,r):n>t&&a==e?Ot("east",t,e,n,e,r):a>e&&n==t?Ot("south",t,e,t,a,r):n<t&&a==e&&Ot("west",t,e,n,e,r)}function Ot(t,e,n,a,r,o){if(e===a&&n===r)return!0;var c=o.tiles,s=o.walls,l=[e,n],i=Object(w["a"])(c[l],4),u=(i[0],i[1],i[2],i[3]),b=V(u,t);if($(s[b])){var d=pt(e,n,t),f=Object(w["a"])(d,2),v=f[0],O=f[1];return Ot(t,v,O,a,r,o)}return!1}function jt(t){return"north"===t?[0,-1]:"east"===t?[1,0]:"south"===t?[0,1]:"west"===t?[-1,0]:void 0}function pt(t,e,n){var a=jt(n),r=Object(w["a"])(a,2),o=r[0],c=r[1];return[t+o,e+c]}function ht(t,e){var n=e,a=n.player,r=n.score;e["events"]=[];var o=Object(w["a"])(a,3),c=o[0],s=o[1],l=o[2];if(r>=U)e=N();else if(l<=0)return N();return nt(t,a,c,s,e)&&(ot(e),it(e),e["score"]>r&&e["score"]===W&&L(e)),e}var yt={dxy_by_key:{ArrowUp:[0,-1],ArrowRight:[1,0],ArrowLeft:[-1,0],ArrowDown:[0,1]},news_by_key:{ArrowUp:"north",ArrowRight:"east",ArrowLeft:"west",ArrowDown:"south"},dxy_by_news:{north:[0,-1],east:[1,0],west:[-1,0],south:[0,1]}},gt=["👹","👺"],mt=["🐾","👣"],wt={isEdge:function(t){var e=t.x,n=t.y,a=t.orientation;return"vertical"===a&&(1===e||7===e)||("horizontal"===a&&(1===n||7===n)||void 0)}},_t={mixins:[I["a"].Mixin],data:function(){var t=rt(),e=t.state,n=t.channel;n.push("msg",{code:e.__code}),window.S=e,window.C=n;var a=[],r=Object(_["range"])(1,8);return r.forEach((function(t){r.forEach((function(e){var n={x:e,y:t,orientation:"vertical"},r={x:e,y:t,orientation:"horizontal"};n.state=wt.isEdge(n)?"solid":"empty",r.state=wt.isEdge(r)?"solid":"empty",a.push(n),a.push(r)}))})),{state:e,channel:n,walls:a,MAX_SCORE:36,last_state:{},turn:0,events:[],message:null,streak:0}},computed:{mousetrap:function(){return{"up,down,left,right":this.pressArrow}},squares:function(){var t=Object(_["range"])(1,7),e=[];return t.forEach((function(n){t.forEach((function(t){e.push({x:t,y:n,class:"game__square -floor -x-".concat(t," -y-").concat(n),index:t+6*n})}))})),e},player:function(){var t=this.state.payload||{},e=t.player,n=void 0===e?{}:e,a=Object(w["a"])(n,3),r=a[0],o=a[1],c=a[2];return{class:"game__player -floor -x-".concat(r," -y-").concat(o),health:Object(_["range"])(3).map((function(t){var e=2*t-c;return{key:t,class:["game-health__heart",e>=0&&"-empty",-1==e&&"-half"]}}))}},player_class:function(){return"game__player -floor -x-".concat(x," -y-").concat(y)},goal_class:function(){if(this.state.payload.goal){var t=Object(w["a"])(this.state.payload.goal,2),e=t[0],n=t[1];return"game__goal -floor -x-".concat(e," -y-").concat(n)}},monsters:function(){var t;return window.monsters=this.state.payload.monsters,null===(t=this.state.payload.monsters)||void 0===t?void 0:t.map((function(t,e){var n=Object(w["a"])(t,4),a=n[0],r=n[1],o=n[2],c=n[3],s=void 0===c?[]:c;return{id:o||e,class:"game__monster -floor -x-".concat(a," -y-").concat(r),icon:gt[e%2],prints:s.filter((function(t){var e=Object(w["a"])(t,2),n=e[0],a=e[1];return n||a})).map((function(t,n){var a=Object(w["a"])(t,2),r=a[0],o=a[1];return{class:"game__pawprint -floor -x-".concat(r," -y-").concat(o," -index-").concat(12-n),icon:mt[e%2]}}))}}))}},watch:{"state.payload.walls":"moveWalls"},mounted:function(){this.moveWalls()},methods:{getWallClass:function(t){var e=t.x,n=t.y,a=t.state,r=t.orientation;return"game__wall -wall -orientation-".concat(r," -x-").concat(e," -y-").concat(n," -state-").concat(a)},pressArrow:function(t){this.channel.push("msg",{input:yt.news_by_key[t.key]}),this.moveWalls()},moveWalls:function(){var t,e,n=this;this.state.payload.score===this.MAX_SCORE?(this.streak=this.streak+1,this.message="You won!",this.turn=0):this.state.payload.player[2]<=0?(this.streak?this.message="You died. ".concat(this.streak," streak ended."):this.message="You died. Try again!",this.turn=0,this.streak=0):(this.message=null,this.turn+=1),this.last_state={score:this.state.payload.score,health:this.state.payload.player[2]};var a=this.state.payload.walls||{};Object.entries(a).forEach((function(t){var e=Object(w["a"])(t,2),n=e[0],r=e[1];"empty"==r&&delete a[n]})),this.walls.filter((function(t){return!wt.isEdge(t)})).forEach((function(t){var e=t.x,n=t.y,r=t.orientation,o=2*e,c=2*n;"vertical"==r?o-=1:c-=1,t.state=a["".concat(o,",").concat(c)]||"empty",t.title="".concat(o,",").concat(c)})),this.events=null===(t=Object(_["flatten"])(this.state.payload.events))||void 0===t?void 0:t.map((function(t){var e=t.from,n=t.to,a=Object(w["a"])(e,2),r=a[0],o=a[1],c=Object(w["a"])(n,2),s=c[0],l=c[1];return{icon:"⚡",class:"game__event -floor  -x-".concat(r," -y-").concat(o),class2:"game__event -floor  -x-".concat(s," -y-").concat(l),id:Math.random()}})),(null===(e=this.events)||void 0===e?void 0:e.length)&&setTimeout((function(){return n.events.forEach((function(t){t["class"]=t.class2}),0)}))}}};const xt=i()(_t,[["render",m]]);var kt=xt,zt={components:{GameBoard:kt}};const Et=i()(zt,[["render",f]]);var At=Et,It=[{path:"/",component:At},{path:"/index.html",component:At}],Mt=Object(d["a"])({history:Object(d["b"])(),routes:It}),St=Mt,Pt=(n("e9c4"),{key:0,class:"event-log"}),Dt=["onClick"];function Ct(t,e,n,r,o,c){var s=Object(a["F"])("unrest-modal");return c.visible?(Object(a["z"])(),Object(a["g"])("div",Pt,[(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["D"])(n.events,(function(t,e){return Object(a["z"])(),Object(a["g"])("div",{key:e,onClick:function(e){return o.selected=t},class:"event-log__row"},Object(a["I"])(e)+": "+Object(a["I"])(JSON.stringify(t)),9,Dt)})),128)),(Object(a["z"])(),Object(a["e"])(a["b"],{to:"body"},[o.selected?(Object(a["z"])(),Object(a["e"])(s,{key:0,onClose:e[0]||(e[0]=function(t){return o.selected=null})},{default:Object(a["L"])((function(){return[Object(a["h"])("div",null,Object(a["I"])(o.selected[0]),1),Object(a["h"])("pre",null,Object(a["I"])(JSON.stringify(o.selected[1],null,4)),1)]})),_:1})):Object(a["f"])("",!0)]))])):Object(a["f"])("",!0)}var Rt={props:{events:Array},data:function(){return{selected:null}},computed:{visible:function(){return this.$route.query.DEBUG||!1}}};n("1837");const Tt=i()(Rt,[["render",Ct]]);var Wt=Tt;n("0488"),n("10d9");Object(a["d"])(b).use(St).use(r["a"].plugin).use(r["a"].ui).component("EventLog",Wt).mount("#app")}});
//# sourceMappingURL=app.242a630d.js.map